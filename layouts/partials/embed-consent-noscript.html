{{- /*
    Embed Consent - NoScript Fallback

    This partial provides fallback behavior for iframes when JavaScript is disabled.
    Include this in your <head> section for better accessibility.

    Usage in baseof.html or head.html:
    {{ partial "embed-consent-noscript.html" . }}

    What it does:
    - Blocks embedded content when JavaScript is disabled
    - Shows informative message that JavaScript is required
    - External services (YouTube, ARTE, Maps) need JavaScript anyway
    - Prevents partially loaded, non-functional iframes

    NOTE: This is a DUPLICATE of the noscript section in embed-consent-config.html
    Only use this file if you're NOT using embed-consent-config.html
*/ -}}
{{- /*
    Fallback: Hide iframes when JavaScript is disabled
    This prevents embedded content from loading without consent

    Since YouTube, Vimeo, Maps, etc. require JavaScript anyway,
    hiding the iframes is the cleanest solution when JS is disabled.

    When JS IS enabled, this style block is immediately removed
    by the script below to prevent FOUC.
*/ -}}
<style id="embed-consent-noscript-standalone">
    /* Hide iframes when JavaScript is disabled */
    iframe:not(.no-consent):not([data-no-consent]) {
        display: none !important;
    }
</style>
<noscript>
    <style>
        /* Style iframes to show blocked state visually at their original position */
        iframe:not(.no-consent):not([data-no-consent]) {
            display: block !important;
            opacity: 0.15 !important;
            pointer-events: none !important;
            filter: grayscale(100%) blur(3px) !important;
            border: 3px dashed #ffc107 !important;
            background: #fff3cd !important;
            min-height: 200px !important;
            position: relative !important;
            box-sizing: border-box !important;
            margin: 1rem 0 !important;
        }

        /* Create a visual striped pattern overlay on each blocked iframe */
        iframe:not(.no-consent):not([data-no-consent])::before {
            content: '' !important;
            display: block !important;
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            right: 0 !important;
            bottom: 0 !important;
            background: repeating-linear-gradient(
                45deg,
                rgba(255, 193, 7, 0.1),
                rgba(255, 193, 7, 0.1) 10px,
                rgba(255, 193, 7, 0.2) 10px,
                rgba(255, 193, 7, 0.2) 20px
            ) !important;
            z-index: 1 !important;
        }

        @media (prefers-color-scheme: dark) {
            iframe:not(.no-consent):not([data-no-consent]) {
                background: #3d3500 !important;
                border-color: #ffc107 !important;
            }
        }
    </style>
</noscript>
<script>
    // CRITICAL: Remove the noscript fallback styles IMMEDIATELY when JavaScript IS available
    // This must run synchronously right after the style tag to prevent FOUC (Flash of Unstyled Content)
    // and ensure iframes don't briefly show as dimmed boxes
    (function() {
        var style = document.getElementById('embed-consent-noscript-standalone');
        if (style && style.parentNode) {
            style.parentNode.removeChild(style);
        }
    })();
</script>
