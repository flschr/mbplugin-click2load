{{- /*
    Embed Consent - NoScript Fallback

    This partial provides fallback behavior for iframes when JavaScript is disabled.
    Include this in your <head> section for better accessibility.

    Usage in baseof.html or head.html:
    {{ partial "embed-consent-noscript.html" . }}

    What it does:
    - Blocks embedded content when JavaScript is disabled
    - Shows informative message that JavaScript is required
    - External services (YouTube, ARTE, Maps) need JavaScript anyway
    - Prevents partially loaded, non-functional iframes

    NOTE: This is a DUPLICATE of the noscript section in embed-consent-config.html
    Only use this file if you're NOT using embed-consent-config.html
*/ -}}
{{- /*
    Fallback: Hide iframes when JavaScript is disabled
    This prevents embedded content from loading without consent

    Since YouTube, Vimeo, Maps, etc. require JavaScript anyway,
    hiding the iframes is the cleanest solution when JS is disabled.

    When JS IS enabled, this style block is immediately removed
    by the script below to prevent FOUC.
*/ -}}
<style id="embed-consent-noscript-standalone">
    /* Hide iframes when JavaScript is disabled */
    iframe:not(.no-consent):not([data-no-consent]) {
        display: none !important;
    }
</style>
<noscript>
    <style>
        /* Global noscript warning when JavaScript is disabled */
        .embed-consent-noscript-warning {
            background: #fff3cd;
            border: 1px solid #ffc107;
            border-radius: 0.5rem;
            padding: 1rem 1.25rem;
            margin: 1.5rem auto;
            max-width: 42rem;
            font-size: 0.875rem;
            line-height: 1.6;
            color: #856404;
            font-family: system-ui, -apple-system, sans-serif;
        }

        .embed-consent-noscript-warning strong {
            display: block;
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            color: #664d03;
        }

        /* Show warning only when iframe is present on page */
        body:has(iframe:not(.no-consent):not([data-no-consent])) .embed-consent-noscript-warning {
            display: block;
        }

        /* Hide by default (only show if iframes present) */
        .embed-consent-noscript-warning {
            display: none;
        }

        /* Fallback for browsers without :has() support - show warning always */
        @supports not (selector(:has(*))) {
            .embed-consent-noscript-warning {
                display: block;
            }
        }

        @media (prefers-color-scheme: dark) {
            .embed-consent-noscript-warning {
                background: #3d3500;
                border-color: #ffc107;
                color: #ffc107;
            }

            .embed-consent-noscript-warning strong {
                color: #ffdb4d;
            }
        }
    </style>
    <div class="embed-consent-noscript-warning">
        <strong>JavaScript required</strong>
        Embedded content (YouTube, Vimeo, Maps, etc.) is not displayed on this page because JavaScript is disabled. These external services require JavaScript to function.
    </div>
</noscript>
<script>
    // CRITICAL: Remove the noscript fallback styles IMMEDIATELY when JavaScript IS available
    // This must run synchronously right after the style tag to prevent FOUC (Flash of Unstyled Content)
    // and ensure iframes don't briefly show as dimmed boxes
    (function() {
        var style = document.getElementById('embed-consent-noscript-standalone');
        if (style && style.parentNode) {
            style.parentNode.removeChild(style);
        }
    })();
</script>
